<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title th:text="${post.title}">NewsTwin</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Bootstrap Icons (â¤ï¸, ğŸ“˜ ë“± ì•„ì´ì½˜ìš©) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
  <link rel="stylesheet" th:href="@{/css/layout/header.css}">
  <style>
    body { background-color:#f8f9fa; }
    .content-wrap { max-width: 720px; margin: auto; background: white; border-radius: .5rem; padding: 1.25rem; box-shadow: 0 0.2rem 1rem rgba(0,0,0,.05); }
    .post-title { font-weight:700; font-size:1.6rem; line-height:1.4; }
    .post-meta { color:#6c757d; font-size:.9rem; }
    .post-image img { width:100%; border-radius:.5rem; margin:1rem 0; }
    .post-body { white-space:pre-line; font-size:1rem; color:#333; line-height:1.7; }
    .reaction-bar { display:flex; align-items:center; gap:1.2rem; margin-top:1.5rem; }
    .reaction-bar button { background:none; border:none; color:#6c757d; cursor:pointer; display:flex; align-items:center; gap:0.4rem; }
    .reaction-bar button:hover { color:#dc3545; }
    .comment-section { margin-top:2rem; }
  </style>
</head>
<body>
<!-- ìƒë‹¨ ë„¤ë¹„ -->
<div th:replace="~{layout/header :: header}"></div>
<!-- ì‚¬ì´ë“œë°” -->
<div class="container-fluid">
<div class="row">
  <div th:replace="~{layout/sidebar :: sidebar}"></div>
<!-- ë³¸ë¬¸ -->
  <main class="col-12 col-md-8 col-lg-7 py-4">
  <div class="content-wrap">
    <!-- ì œëª© -->
    <h1 class="post-title" th:text="${post.title}">ì œëª©</h1>

    <!-- ë©”íƒ€ì •ë³´ -->
    <div class="post-meta mb-2">
      <span th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd HH:mm')}">2025-10-31</span>
      <span th:if="${post.categoryName != null}">
        Â· <span th:text="${post.categoryName}">ì¹´í…Œê³ ë¦¬</span>
      </span>
       ì¡°íšŒìˆ˜ <span th:text="${post.count}"></span>
    </div>

    <!-- ì¸ë„¤ì¼ -->
    <div class="post-image" th:if="${post.thumbnailUrl != null}">
      <img th:src="${post.thumbnailUrl}" alt="thumbnail">
    </div>

    <!-- ë³¸ë¬¸ -->
    <div class="post-body" th:utext="${post.content}"></div>

    <!-- ë°˜ì‘ ë²„íŠ¼ -->
    <div class="reaction-bar">

      <button id="likeBtn"
              class="btn btn-light border-0 d-flex align-items-center gap-1"
              th:data-post-id="${post.id}"
              th:data-liked="${liked}">
        <span id="heartIcon" th:text="${liked} ? 'â¤ï¸' : 'ğŸ¤'"></span>
        <span id="likeCount" th:text="${likeCount}">0</span>
        <span>ì¢‹ì•„ìš”</span>
      </button>

      <button id="bookmarkBtn"
              class="btn btn-light border-0 d-flex align-items-center gap-1"
              th:data-post-id="${post.id}"
              th:data-bookmarked="${bookmarked}">
        <i id="bookmarkIcon"
           th:class="${bookmarked} ? 'bi bi-bookmark-fill' : 'bi bi-bookmark'"></i>
        <span>ë¶ë§ˆí¬</span>
      </button>
    </div>

    <!-- ëŒ“ê¸€ -->
    <div class="comment-section mt-4">
      <h6 class="fw-semibold">ëŒ“ê¸€</h6>

      <!-- ì‘ì„±í¼ -->
      <div class="mb-3">
        <textarea id="commentInput" class="form-control" rows="3" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
        <div class="d-flex justify-content-end mt-2">
          <button id="commentSubmit" class="btn btn-primary btn-sm">ë“±ë¡</button>
        </div>
      </div>

      <!-- ëª©ë¡ -->
      <ul id="commentList" class="list-unstyled"></ul>

      <!-- ë¬´í•œìŠ¤í¬ë¡¤ sentinel -->
      <div id="commentSentinel" class="py-3 text-center text-secondary small">ë” ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦</div>
    </div>
  </div>
</main>
</div>
</div>
<div th:replace="~{layout/footer :: footer}"></div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="/js/layout/header.js" defer></script>
<script th:inline="javascript">
  const IS_LOGGED_IN = [[${isLoggedIn}]];
</script>
<script src="/js/subscription.js" defer></script>
<script src="/js/postdetail.js" defer></script>
<script src="/js/comments.js" defer></script>
</body>
</html>